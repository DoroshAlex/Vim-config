<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
 <head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Регистрирует потоковый фильтр, определённый пользователем</title>

 </head>
 <body><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-filter-prepend.html">stream_filter_prepend</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-filter-remove.html">stream_filter_remove</a></div>
 <div class="up"><a href="ref.stream.html">Stream Функции</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div><hr /><div id="function.stream-filter-register" class="refentry">
 <div class="refnamediv">
  <h1 class="refname">stream_filter_register</h1>
  <p class="verinfo">(PHP 5)</p><p class="refpurpose"><span class="refname">stream_filter_register</span> &mdash; <span class="dc-title">Регистрирует потоковый фильтр, определённый пользователем</span></p>

 </div>
 <div class="refsect1 description" id="refsect1-function.stream-filter-register-description">
  <h3 class="title">Описание</h3>
  <div class="methodsynopsis dc-description">
   <span class="type">bool</span> <span class="methodname"><b>stream_filter_register</b></span>
    ( <span class="methodparam"><span class="type">string</span> <tt class="parameter">$filtername</tt></span>
   , <span class="methodparam"><span class="type">string</span> <tt class="parameter">$classname</tt></span>
   )</div>

  <p class="para rdfs-comment">
   <span class="function"><b>stream_filter_register()</b></span> позволяет вам реализовать
   ваш собственный фильтр на любом зарегистрированном потоке, используемом со всеми другими
   функциями файловой системы (такими как <span class="function"><a href="function.fopen.html" class="function">fopen()</a></span>,
   <span class="function"><a href="function.fread.html" class="function">fread()</a></span> и т. д.).
  </p>
 </div>

 
 <div class="refsect1 parameters" id="refsect1-function.stream-filter-register-parameters">
  <h3 class="title">Список параметров</h3>
  <p class="para">
   <dl>

    <dt>

     <span class="term"><i><tt class="parameter">filtername</tt></i></span>
     <dd>

      <p class="para">
       Название регистрируемого фильтра.
      </p>
     </dd>

    </dt>

    <dt>

     <span class="term"><i><tt class="parameter">classname</tt></i></span>
     <dd>

      <p class="para">
       Для того, чтобы реализовать фильтр, вам нужно определить класс как расширение
       <i>php_user_filter</i> c функциями-членами как указано ниже. При
       выполнении операций чтения/записи на потоке, к которому прикреплён ваш фильтр,
       PHP будет передавать данные через ваш фильтр (и через любые другие фильтры, 
       прикреплённые к потоку) так что данные могут быть изменены как требуется. 
       Вы должны реализовать методы точно как описано ниже. Иная реализация 
       приведёт к непредсказуемому поведению.
      </p>
      <div class="methodsynopsis dc-description">
       <span class="type">int</span> <span class="methodname"><b>filter</b></span>
        ( <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$in</tt></span>
       , <span class="methodparam"><span class="type">resource</span> <tt class="parameter">$out</tt></span>
       , <span class="methodparam"><span class="type">int</span> <tt class="parameter reference">&$consumed</tt></span>
       , <span class="methodparam"><span class="type">bool</span> <tt class="parameter">$closing</tt></span>
       )</div>

      <p class="para">
       Этот метод вызывается каждый раз, когда данные читаются или записываются в 
       прикреплённый поток (такой, как с функциями <span class="function"><a href="function.fread.html" class="function">fread()</a></span> или <span class="function"><a href="function.fwrite.html" class="function">fwrite()</a></span>). 
       Переменная <i><tt class="parameter">in</tt></i> - это ресурс, указывающий на последовательный поток данных 
       (<i>bucket brigade</i>), который содержит одну или больше единиц данных
       (<i>bucket</i>), содержащих данные для фильтрации. 
       Переменная <i><tt class="parameter">out</tt></i> - это ресурс, указывающий на второй последовательный 
       поток данных (<i>bucket brigade</i>), в который должны быть помещены ваши 
       модифицированные единицы данных (buckets). 
       Переменная <i><tt class="parameter">consumed</tt></i>, которая должна 
       <em class="emphasis">всегда</em> передаваться по ссылке, должна быть увеличена на длину 
       данных, которые ваш фильтр читает и изменяет. В большинстве случаев это означает, 
       что вы будете увеличивать  <i><tt class="parameter">consumed</tt></i> на 
       <i>$bucket-&gt;datalen</i> для каждого <i>$bucket</i>. 
       Если поток в процессе закрытия (и таким образом это последний проход по цепочке 
       фильтров), параметр  <i><tt class="parameter">closing</tt></i> будет установлен в значение 
       <b><tt>TRUE</tt></b>. Метод   <span class="methodname"><b>filter()</b></span> должен возвращать одно из трёх 
       предопределённых значений после завершения.
       <table class="doctable informaltable">
        
         <thead valign="middle">
          <tr valign="middle">
           <th>Возвращаемое значение</th>
           <th>Смысл</th>
          </tr>

         </thead>

         <tbody valign="middle" class="tbody">
          <tr valign="middle">
           <td align="left"><b><tt>PSFS_PASS_ON</tt></b></td>
           <td align="left">
            Фильтр отработал успешно, данные доступны в 
            <i><tt class="parameter">out</tt></i> <i>bucket brigade</i>.
           </td>
          </tr>

          <tr valign="middle">
           <td align="left"><b><tt>PSFS_FEED_ME</tt></b></td>
           <td align="left">
            Фильтр отработал успешно,однако данные не доступны для возврата. Требуется
            больше данных из потока или предыдущего фильтра.
           </td>
          </tr>

          <tr valign="middle">
           <td align="left"><b><tt>PSFS_ERR_FATAL</tt></b> (по умолчанию)</td>
           <td align="left">
            Фильтр получил неисправимую ошибку и не может продолжать.
           </td>
          </tr>

         </tbody>
        
       </table>

      </p>
      <div class="methodsynopsis dc-description">
       <span class="type">bool</span> <span class="methodname"><b>onCreate</b></span>
        ( <span class="methodparam">void</span>
       )</div>

      <span class="simpara">
       Этот метод вызывается во время создания объекта класса
    фильтра. Если ваш фильтр выделяет или инициализирует любые другие
    ресурсы (такие, как буфер), то нужно делать это здесь. Ваша реализация
    этого метода должна возвращать <b><tt>FALSE</tt></b> в случае неудачи или <b><tt>TRUE</tt></b> в случае успеха.
      </span>
      <span class="simpara">
       Когда создаётся первый экземпляр вашего фильтра и вызывается метод
       <i>yourfilter-&gt;onCreate()</i>, будет доступно несколько свойств,
       показанных в таблице ниже.
      </span>
      <p class="para">
       <table class="doctable informaltable">
        
         <thead valign="middle">
          <tr valign="middle">
           <th>Свойство</th>
           <th>Содержимое</th>
          </tr>

         </thead>

         <tbody valign="middle" class="tbody">
          <tr valign="middle">
           <td align="left"><i>FilterClass-&gt;filtername</i></td>
           <td align="left">
            Строка, содержащая название фильтра, экземпляр которого был создан.
            Фильтры могут быть зарегистрированы под разными именами или шаблонами.
            Используйте это свойство для того, чтобы определить какое название было
            использовано.
           </td>
          </tr>

          <tr valign="middle">
           <td align="left"><i>FilterClass-&gt;params</i></td>
           <td align="left">
            Содержимое параметра <i><tt class="parameter">params</tt></i>, переданного 
            функции <span class="function"><a href="function.stream-filter-append.html" class="function">stream_filter_append()</a></span>
            или <span class="function"><a href="function.stream-filter-prepend.html" class="function">stream_filter_prepend()</a></span>.
           </td>
          </tr>

          <tr valign="middle">
           <td align="left"><i>FilterClass-&gt;stream</i></td>
           <td align="left">
            Ресурс фильтруемого потока. Может быть доступен только во время вызовов
             <span class="methodname"><b>filter()</b></span>, когда параметр <i>closing</i> 
            установлен в значение <b><tt>FALSE</tt></b>.
           </td>
          </tr>

         </tbody>
        
       </table>

      </p>
      <div class="methodsynopsis dc-description">
       <span class="type"><span class="type void">void</span></span> <span class="methodname"><b>onClose</b></span>
        ( <span class="methodparam">void</span>
       )</div>

      <p class="para">
       Этот метод вызывается во время завершения фильтра (обычно это происходит во время
       завершения потока), и выполняется  <em class="emphasis">после</em> того, как был
    вызван метод <i>flush</i>. Если любые ресурсы были выделены или
    инициализированы во время вызова метода <i>onCreate()</i>, то
    здесь следует их уничтожить или избавиться от них.
      </p>
     </dd>

    </dt>

   </dl>

  </p>
 </div>

 
 <div class="refsect1 returnvalues" id="refsect1-function.stream-filter-register-returnvalues">
  <h3 class="title">Возвращаемые значения</h3>
  <p class="para">
   Возвращает <b><tt>TRUE</tt></b> в случае успешного завершения  или <b><tt>FALSE</tt></b> в случае возникновения ошибки.
  </p>
  <p class="para">
   <span class="function"><b>stream_filter_register()</b></span> будет возвращать  <b><tt>FALSE</tt></b> если
   фильтр с именем <i><tt class="parameter">filtername</tt></i> уже определён.
  </p>
 </div>

 
 <div class="refsect1 examples" id="refsect1-function.stream-filter-register-examples">
  <h3 class="title">Примеры</h3>
  <p class="para">
   <div class="example" id="example-3614">
    <p><b>Пример #1 Фильтр для перевода букв в верхний регистр в потоке <var class="filename">foo-bar.txt</var></b></p>
    <div class="example-contents"><p>
     Пример ниже реализует фильтр с названием <i>strtoupper</i>
     на файловом потоке  <var class="filename">foo-bar.txt</var>, который будет переводить 
     в заглавные все буквы, которые пишутся/читаются из этого потока.
    </p></div>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;Определяем&nbsp;наш&nbsp;класс&nbsp;фильтра&nbsp;*/<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">strtoupper_filter&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">php_user_filter&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">filter</span><span style="color: #007700">(</span><span style="color: #0000BB">$in</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$out</span><span style="color: #007700">,&nbsp;&amp;</span><span style="color: #0000BB">$consumed</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$closing</span><span style="color: #007700">)<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">$bucket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_bucket_make_writeable</span><span style="color: #007700">(</span><span style="color: #0000BB">$in</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$consumed&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">datalen</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stream_bucket_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$out</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">PSFS_PASS_ON</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;Регистрируем&nbsp;наш&nbsp;фильтр&nbsp;в&nbsp;&nbsp;PHP&nbsp;*/<br /></span><span style="color: #0000BB">stream_filter_register</span><span style="color: #007700">(</span><span style="color: #DD0000">"strtoupper"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"strtoupper_filter"</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Не&nbsp;удалось&nbsp;зарегистрировать&nbsp;фильтр"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"foo-bar.txt"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"w"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Присоединяем&nbsp;зарегистрированный&nbsp;фильтр&nbsp;к&nbsp;только&nbsp;что&nbsp;открытому&nbsp;потоку&nbsp;*/<br /></span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"strtoupper"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Line1\n"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Word&nbsp;-&nbsp;2\n"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Easy&nbsp;As&nbsp;123\n"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Читаем&nbsp;содержимое&nbsp;снова<br />&nbsp;*/<br /></span><span style="color: #0000BB">readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">"foo-bar.txt"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
LINE1
WORD - 2
EASY AS 123
</pre></div>
    </div>
   </div>
  </p>
  <p class="para">
   <div class="example" id="example-3615">
    <p><b>Пример #2 Регистрация стандартного фильтра, соответствующего множественным именам фильтров.</b></p>
    <div class="example-contents">
<div class="phpcode"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br /></span><span style="color: #FF8000">/*&nbsp;Определяем&nbsp;наш&nbsp;класс&nbsp;фильтра&nbsp;*/<br /></span><span style="color: #007700">class&nbsp;</span><span style="color: #0000BB">string_filter&nbsp;</span><span style="color: #007700">extends&nbsp;</span><span style="color: #0000BB">php_user_filter&nbsp;</span><span style="color: #007700">{<br />&nbsp;&nbsp;var&nbsp;</span><span style="color: #0000BB">$mode</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">filter</span><span style="color: #007700">(</span><span style="color: #0000BB">$in</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$out</span><span style="color: #007700">,&nbsp;&amp;</span><span style="color: #0000BB">$consumed</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$closing</span><span style="color: #007700">)<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">$bucket&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">stream_bucket_make_writeable</span><span style="color: #007700">(</span><span style="color: #0000BB">$in</span><span style="color: #007700">))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mode&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtoupper</span><span style="color: #007700">(</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;elseif&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mode&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">data</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$consumed&nbsp;</span><span style="color: #007700">+=&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">datalen</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">stream_bucket_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$out</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$bucket</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">PSFS_PASS_ON</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">onCreate</span><span style="color: #007700">()<br />&nbsp;&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">filtername&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'str.toupper'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">1</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;elseif&nbsp;(</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">filtername&nbsp;</span><span style="color: #007700">==&nbsp;</span><span style="color: #DD0000">'str.tolower'</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$this</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">mode&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">0</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">/*&nbsp;Был&nbsp;вызван&nbsp;какой-то&nbsp;другой&nbsp;фильтр&nbsp;str.*,<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;возвращаем&nbsp;ошибку,&nbsp;чтобы&nbsp;&nbsp;PHP&nbsp;мог&nbsp;продолжить&nbsp;его&nbsp;поиск&nbsp;*/<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">true</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;Регистрируем&nbsp;наш&nbsp;фильтр&nbsp;в&nbsp;&nbsp;PHP&nbsp;*/<br /></span><span style="color: #0000BB">stream_filter_register</span><span style="color: #007700">(</span><span style="color: #DD0000">"str.*"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"string_filter"</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;or&nbsp;die(</span><span style="color: #DD0000">"Не&nbsp;удалось&nbsp;зарегистрировать&nbsp;фильтр"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">$fp&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #DD0000">"foo-bar.txt"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"w"</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Присоединяем&nbsp;зарегистрированный&nbsp;фильтр&nbsp;к&nbsp;только&nbsp;что&nbsp;открытому&nbsp;потоку<br />&nbsp;&nbsp;&nbsp;Мы&nbsp;могли&nbsp;бы&nbsp;использовать&nbsp;здесь&nbsp;&nbsp;str.tolower&nbsp;*/<br /></span><span style="color: #0000BB">stream_filter_append</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"str.toupper"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Line1\n"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Word&nbsp;-&nbsp;2\n"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">fwrite</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"Easy&nbsp;As&nbsp;123\n"</span><span style="color: #007700">);<br /><br /></span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$fp</span><span style="color: #007700">);<br /><br /></span><span style="color: #FF8000">/*&nbsp;Читаем&nbsp;содержимое&nbsp;снова<br />&nbsp;*/<br /></span><span style="color: #0000BB">readfile</span><span style="color: #007700">(</span><span style="color: #DD0000">"foo-bar.txt"</span><span style="color: #007700">);<br /></span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
    </div>

    <div class="example-contents"><p>Результат выполнения данного примера:</p></div>
    <div class="example-contents screen">
<div class="cdata"><pre>
LINE1
WORD - 2
EASY AS 123
</pre></div>
    </div>
   </div>
  </p>
 </div>

 
 <div class="refsect1 seealso" id="refsect1-function.stream-filter-register-seealso">
  <h3 class="title">Смотрите также</h3>
  <p class="para">
   <ul class="simplelist">
    <li class="member"><span class="function"><a href="function.stream-wrapper-register.html" class="function" rel="rdfs-seeAlso">stream_wrapper_register()</a> - Регистрирует обёртку  URL, реализованную в виде PHP-класса</span></li>
    <li class="member"><span class="function"><a href="function.stream-filter-append.html" class="function" rel="rdfs-seeAlso">stream_filter_append()</a> - Прикрепляет фильтр к потоку</span></li>
    <li class="member"><span class="function"><a href="function.stream-filter-prepend.html" class="function" rel="rdfs-seeAlso">stream_filter_prepend()</a> - Прикрепляет фильтр к потоку</span></li>
   </ul>
  </p>
 </div>

</div><hr /><div class="manualnavbar" style="text-align: center;">
 <div class="prev" style="text-align: left; float: left;"><a href="function.stream-filter-prepend.html">stream_filter_prepend</a></div>
 <div class="next" style="text-align: right; float: right;"><a href="function.stream-filter-remove.html">stream_filter_remove</a></div>
 <div class="up"><a href="ref.stream.html">Stream Функции</a></div>
 <div class="home"><a href="index.html">PHP Manual</a></div>
</div></body></html>
